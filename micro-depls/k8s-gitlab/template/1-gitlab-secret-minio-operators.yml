
## https://docs.gitlab.com/charts/installation/secrets.html#manual-secret-creation-optional



- type: replace
  path: /instance_groups/name=k8s-helm-addons/jobs/name=action/properties/actions/-
  value:
    type: secret
    name: object-storage
    namespace: gitlab
    data:
    - name: connection
      value: |
        provider: AWS
        aws_access_key_id: minio
        aws_secret_access_key: ((minio-secret-key))
        region: us-east-1
        endpoint: "http://gitlab-minio.gitlab.svc.cluster.local:9000"
        aws_signature_version: 4
        host: gitlab-minio.gitlab.svc.cluster.local
        path_style: false

- type: replace
  path: /instance_groups/name=k8s-helm-addons/jobs/name=action/properties/actions/-
  value:
    type: secret
    name: s3cmd-config
    namespace: gitlab
    data:
    - name: config
      value: |
        [default]
        access_key: minio
        secret_key: ((minio-secret-key))
        use_https = True
        bucket_location: us-east-1
        host_base = gitlab-minio.gitlab.svc.cluster.local:9000
        host_bucket = %(bucket)s.gitlab-minio.gitlab.svc.cluster.local:9000
        signature_v2 = False

- type: replace
  path: /instance_groups/name=k8s-helm-addons/jobs/name=action/properties/actions/-
  value:
    type: secret
    name: s3access
    namespace: gitlab
    data:
    - name: accesskey
      value: minio
    - name: secretkey
      value: ((minio-secret-key))

- type: replace
  path: /instance_groups/name=k8s-helm-addons/jobs/name=action/properties/actions/-
  value:
    type: secret
    name: gitlab-minio-secret
    namespace: gitlab
    data:
    - name: accesskey
      value: minio
    - name: secretkey
      value: ((minio-secret-key))



- type: replace
  path: /variables?/-
  value:
    name: minio-secret-key
    type: password