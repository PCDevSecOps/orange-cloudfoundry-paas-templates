
- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: gitlab-postgresql-password
    namespace: gitlab
    data:
    - name: pg_su_username
      value: postgres
    - name: pg_repl_username
      value: postgres
    - name: postgresql-replication-password
      value: ((gitlab-postgres-password))
    - name: postgresql-password
      value: ((gitlab-postgres-password))

- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: gitlab-ldap-password
    namespace: gitlab
    data:
    - name: ldap-password
      value: '((/secrets/ldap_root_password))'

- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: gitlab-redis-password
    namespace: gitlab
    data:
    - name: redis-password
      value: ((gitlab-redis-password))

- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: gitlab-root-password
    namespace: gitlab
    data:
    - name: password
      value: ((gitlab-password))


- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: registry-storage
    namespace: gitlab
    data:
    - name: config
      value: |
        s3:
        bucket: gitlab-registry-storage
        accesskey: minio
        secretkey: ((minio-secret-key))
        region: us-east-1
        regionendpoint: "http://gitlab-minio.gitlab.svc.cluster.local:9000"
        v4auth: true

- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: object-storage
    namespace: gitlab
    data:
    - name: connection
      value: |
        provider: AWS
        aws_access_key_id: minio
        aws_secret_access_key: ((minio-secret-key))
        region: us-east-1
        endpoint: "http://gitlab-minio.gitlab.svc.cluster.local:9000"
        aws_signature_version: 4
        host: gitlab-minio.gitlab.svc.cluster.local
        path_style: false



      #
#- type: replace
#  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
#  value:
#    name: gitlab-minio-secret
#    namespace: gitlab
#    data:
#    - name: accesskey
#      value: minio
#    - name: secretkey
#      value: ((minio-secret-key))
#
#
- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: s3cmd-config
    namespace: gitlab
    data:
    - name: config
      value: |
        [default]
        access_key: minio
        secret_key: ((minio-secret-key))
        use_https = True
        bucket_location: us-east-1
        host_base = gitlab-minio.gitlab.svc.cluster.local:9000
        host_bucket = %(bucket)s.gitlab-minio.gitlab.svc.cluster.local:9000
        signature_v2 = False

- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/secrets/-
  value:
    name: s3access
    namespace: gitlab
    data:
    - name: accesskey
      value: minio
    - name: secretkey
      value: ((minio-secret-key))






- type: replace
  path: /variables?/-
  value:
    name: gitlab-postgres-password
    type: password

- type: replace
  path: /variables?/-
  value:
    name: gitlab-redis-password
    type: password

- type: replace
  path: /variables?/-
  value:
    name: gitlab-password
    type: password

- type: replace
  path: /variables?/-
  value:
    name: minio-secret-key
    type: password