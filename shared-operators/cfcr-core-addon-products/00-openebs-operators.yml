
- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/commands/-
  value:
    name: "openebs-cstor-sparse"
    cmd: "apply"
    options: ""
    apply:
      apiVersion: storage.k8s.io/v1
      kind: StorageClass
      metadata:
        name: openebs-cstor-sparse
        annotations:
          openebs.io/cas-type: cstor
          cas.openebs.io/config: |
            - name: StoragePoolClaim
              value: "sparse-claim-auto"
            - name: VolumeMonitor
              enabled: "true"

      provisioner: openebs.io/provisioner-iscsi

- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/commands/-
  value:
    name: "sparse-claim-auto"
    cmd: "apply"
    options: ""
    apply:
      apiVersion: openebs.io/v1alpha1
      kind: StoragePoolClaim
      metadata:
        name: sparse-claim-auto
        namespace: openebs
        annotations:
          # default PoolResourceRequests.value.cpu 100m
          cas.openebs.io/config: |
            - name: PoolResourceRequests
              value: |-
                  memory: 1Gi
                  cpu: 50m

            - name: PoolResourceLimits
              value: |-
                  memory: 4Gi
            - name: AuxResourceLimits
              value: |-
                  memory: 0.5Gi
                  cpu: 50m
            - name: Tolerations
              value: |-
                 t1:
                   key: openebs
                   operator: Exists
                   effect: NoExecute

      spec:
        name: sparse-claim-auto
        type: sparse
        maxPools: 3
        poolSpec:
          poolType: striped
          cacheFile: /var/vcap/store/openebs/sparse/sparse-claim-auto.cache
          overProvisioning: false


- type: replace
  path: /instance_groups/name=cfcr-helm-addons/jobs/name=kubectl/properties/commands/-
  value:
    name: "storageclass-openebs-hostpath-custom"
    cmd: "apply"
    options: ""
    apply:
      kind: "StorageClass"
      apiVersion: "storage.k8s.io/v1"
      metadata:
        name: "openebs-hostpath-custom"
        annotations:
          cas.openebs.io/config: "- name: StorageType\n  value: \"hostpath\"\n- name: BasePath\n  value: \"/var/vcap/store/openebs/local\"\n"
          openebs.io/cas-type: "local"

      provisioner: "openebs.io/local"
      reclaimPolicy: "Delete"
      volumeBindingMode: "WaitForFirstConsumer"
